---
title: 自适应高度的输入框
reward: true
date: 2019-12-10 22:15:19
permalink: 10
categories: VueJS
tags:
---

　　有时候我们需要一个高度能随内容自动增加的输入框，`input` 显然不行，因为 `input` 里的文字是不换行的。文本域 `textarea` 里的文字倒是换行的，可一旦文字内容超过其高度，`textarea` 就会增加一个烦人的滚动条，这是很影响视觉的，就如同下面：
```html
<textarea cols="30" rows="3"></textarea>
```

<textarea cols="30" rows="3"></textarea>


　　那么有没有办法制作一个高度能随文字内容自动增加的输入框呢？答案是肯定的，下面介绍两种方式。

### 方式一

　　这种方式依然使用 `textarea`, 主要思想是我们将 `textarea` 放入一个容器中，同时在这个容器中放入一个隐藏的 div (visibility: hidden), 监听 `textarea` 的输入事件并将其中的文字动态的同步到隐藏的div中，这样div 就可以撑开容器，这时设置 `textarea` 的高度为 100% 并将其定位到容器的左上角，那么 `textarea` 的高度自然就是其中文字内容的高度了。

```html
   <!-- demo-1.html -->

   <div class="container">
      <div></div>
      <textarea></textarea> 
   </div>
   
   <style>
      .container {
         width: 500px;
         position: relative;
      }
      .container div {         
         visibility: hidden;
         /** 避免初始化时容器没有高度 */
         padding: 8px 0px;
      }
      .container textarea {
         width: 100%;
         height: 100%;
         position: absolute;
         top: 0px;
         padding: 0px;
         /** 必须设置为 content-box !!! */ 
         box-sizing: content-box;
      }
   </style>

   <script>
      const textarea = document.querySelector('.container textarea');
      const div = document.querySelector('.container div');
      textarea.addEventListener('input', (e) => {
         div.innerText = e.target.value;
      });
   </script>
```
尝试输入一段文字吧：
   <div class="container-0"><div></div><textarea></textarea></div>
   
   <style>
      .container-0 {
         width: 500px;
         position: relative;
      }
      .container-0 div {
         visibility: hidden;
         padding: 8px 0px;
      }
      .container-0 textarea {
         width: 100%;
         height: 100%;
         position: absolute;
         top: 0px;
         padding: 0px;
         box-sizing: content-box;
      }
   </style>

   <script>
      (function() {
         const textarea = document.querySelector('.container-0 textarea');
         const div = document.querySelector('.container-0 div');
         textarea.addEventListener('input', (e) => {
            div.innerText = e.target.value;
         });
      })();
   </script>


　　你可能已经注意到了，当我们输入文字时，输入框的高度显然要比文字内容高许多，伴随着输入文字的增多。高度差会越来越大，这是因为隐藏 `div` 与 文本域 `textarea` 内字体的尺寸与行高是不同的， `div` 内的字体尺寸与行高要比 `textarea` 内的大，所以 `div` 撑开的容器高度自然要高于 `textarea` 内的文字内容高度。要解决这个问题，统一它们的字体尺寸与行高就可以了。(注：`div` 的字体尺寸与行高默认继承自父元素)

```html
   <!-- demo-1.html -->

   <div class="container">
      <div></div>
      <textarea></textarea> 
   </div>

   <style>
      .container {
         width: 500px;
         position: relative;
         font-size: 14px;
         line-height: 16px;
      }
      .container div {
         visibility: hidden;
         /** 避免初始化时容器没有高度 */
         padding: 8px 0px;
      }
      .container textarea {
         width: 100%;
         height: 100%;
         position: absolute;
         top: 0px;
         padding: 0px;
         /** 必须设置为 content-box !!! */
         box-sizing: content-box;
         /** 设置字体尺寸与行高继承自父元素 */
         font-size: inherit;
         line-height: inherit;
         /* 去掉右下角的调整大小的标志 */
         resize: none;
      }
   </style>
   <script>
      const textarea = document.querySelector('.container textarea');
      const div = document.querySelector('.container div');
      textarea.addEventListener('input', (e) => {
         div.innerText = e.target.value;
      });
   </script>
```
尝试输入一段文字吧：
   <div class="container-1"><div></div><textarea></textarea></div>

   <style>
      .container-1 {
         width: 500px;
         position: relative;
         font-size: 14px;
         line-height: 16px;
      }
      .container-1 div {
         visibility: hidden;
         padding: 8px 0px;
      }
      .container-1 textarea {
         width: 100%;
         height: 100%;
         position: absolute;
         top: 0px;
         padding: 0px;
         box-sizing: content-box;
         font-size: inherit;
         line-height: inherit;
         resize: none;
      }
   </style>
   <script>
      (function(){
         const textarea = document.querySelector('.container-1 textarea');
         const div = document.querySelector('.container-1 div');
         textarea.addEventListener('input', (e) => {
            div.innerText = e.target.value;
         });
      })();
   </script>

   这样一来高度就一致了。

### 方式二

　　